<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editar Reporte – CityRepair</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="../src/css/styles.css">
  <link rel="stylesheet" href="../src/css/reportar.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="container">
      <div class="brand-left">
        <div class="avatar-sm">E</div>
        <div class="brand-txt">
          <span class="brand-title">CityRepair</span>
          <span class="brand-sub">Sistema de Reportes EDET</span>
        </div>
      </div>

      <nav class="nav-right">
        <a class="nav-item" href="../index.html">
          <span class="icon"><i class="bi bi-house"></i></span> Inicio
        </a>
        <a class="nav-item" href="./reportar.html">
          <span class="icon"><i class="bi bi-flag"></i></span> Reportar
        </a>
        <a class="nav-item active" href="./mis-reportes.html">
          <span class="icon"><i class="bi bi-clipboard2-check"></i></span> Mis Reportes
        </a>
        <a class="nav-item" href="./contacto.html">
          <span class="icon"><i class="bi bi-telephone"></i></span> Contacto
        </a>

        <a class="nav-item" href="./login.html" data-login-link>
          <span class="icon"><i class="bi bi-box-arrow-in-right"></i></span> Acceder
        </a>

        <div class="nav-item user-pill" data-user-panel hidden id="userMenuBtn">
          <img src="" alt="avatar" class="user-avatar" data-user-avatar>
          <span data-user-name></span>
          <div class="user-dropdown" id="userDropdown" hidden>
            <button id="logoutFromMenu">Cerrar sesión</button>
          </div>
        </div>

        <button class="hamburger" id="openDrawer" aria-label="Abrir menú">
          <i class="bi bi-list"></i>
        </button>
      </nav>
    </div>
    <div class="navbar-divider"></div>
  </header>

  <!-- Drawer móvil -->
  <div class="drawer-overlay" id="drawerOverlay"></div>
  <aside class="drawer" id="drawer" aria-hidden="true">
    <button class="drawer-close" id="closeDrawer" aria-label="Cerrar">×</button>
    <div class="drawer-header">
      <div class="avatar-sm">E</div>
      <div class="brand-txt">
        <span class="brand-title">CityRepair</span>
        <span class="brand-sub">Sistema de Reportes EDET</span>
      </div>
    </div>
    <nav class="drawer-nav">
      <a class="drawer-link" href="../index.html">Inicio</a>
      <a class="drawer-link" href="./reportar.html">Reportar</a>
      <a class="drawer-link" href="./mis-reportes.html">Mis Reportes</a>
      <a class="drawer-link" href="./contacto.html">Contacto</a>

      <a class="drawer-link" href="./login.html" data-login-link id="drawerLogin">Acceder</a>
      <div class="drawer-link" data-user-panel hidden>
        <span data-user-name></span>
      </div>
      <button class="drawer-link" id="drawerLogout" data-logout hidden>Cerrar sesión</button>
    </nav>
  </aside>

  <!-- HERO -->
  <section class="hero">
    <div class="container hero-inner">
      <div class="avatar-lg">E</div>
      <h1>Editar Reporte</h1>
      <p class="subtitle">Modifica la información mientras esté pendiente</p>
    </div>
  </section>

  <!-- FORMULARIO -->
  <main class="container">
    <form id="form-editar" class="form-grid">

      <!-- Tipo de problema -->
      <section class="card form-card">
        <h3 class="card-title">Tipo de Problema <span class="req">*</span></h3>
        <label class="field">
          <select id="tipo" required>
            <option value="corte">Corte de luz</option>
            <option value="poste">Poste dañado</option>
            <option value="cable">Cable caído</option>
          </select>
        </label>
      </section>

      <!-- Ubicación -->
      <section class="card form-card">
        <h3 class="card-title">Ubicación <span class="req">*</span></h3>
        <label class="field">
          <input type="text" id="ubicacion" required />
        </label>
      </section>

      <!-- Zona -->
      <section class="card form-card">
        <h3 class="card-title">Zona <span class="req">*</span></h3>
        <label class="field">
          <select id="zona" required>
            <option value="San Miguel de Tucumán">San Miguel de Tucumán</option>
            <option value="Tafí Viejo">Tafí Viejo</option>
            <option value="Yerba Buena">Yerba Buena</option>
            <option value="Lules">Lules</option>
            <option value="Banda del Río Salí">Banda del Río Salí</option>
            <option value="Otra">Otra</option>
          </select>
        </label>
      </section>

      <!-- Mapa -->
      <section class="card form-card form-span-2">
        <h3 class="card-title">Ubicación en el Mapa</h3>
        <div id="coords" class="muted" style="margin-bottom:6px;"></div>
        <div id="map" class="map-box"></div>
        <p class="map-hint muted">
          Haz clic en el mapa para ajustar la ubicación (se guardan las coordenadas).
        </p>
      </section>

      <!-- Fotos -->
      <section class="card form-card form-span-2">
        <h3 class="card-title">Fotos del Problema</h3>
        <p class="muted">
          Puedes eliminar fotos existentes o agregar nuevas. Las nuevas se sumarán al reporte.
        </p>

        <!-- imágenes actuales -->
        <div id="preview-imagenes-actuales" class="edit-preview-list muted"></div>

        <!-- nuevas imágenes -->
        <label class="field">
          <input id="imagenes" type="file" accept="image/*" multiple />
        </label>
        <p class="muted" style="font-size:0.8rem;">
          Formatos permitidos: JPG, PNG. Peso máximo recomendado por archivo: 5 MB.
        </p>
      </section>

      <!-- Descripción -->
      <section class="card form-card form-span-2">
        <h3 class="card-title">Descripción del Problema <span class="req">*</span></h3>
        <label class="field">
          <textarea id="descripcion" required></textarea>
        </label>

        <div class="actions">
          <a href="./mis-reportes.html" class="btn btn-outline">Cancelar</a>
          <button type="submit" class="btn btn-green">Guardar cambios</button>
        </div>
      </section>

      <!-- Historial -->
      <section class="card form-card form-span-2">
        <h3 class="card-title">Historial de modificaciones</h3>
        <ul id="historial-lista" class="historial-list muted">
          <li>No hay modificaciones registradas.</li>
        </ul>
      </section>

    </form>
  </main>

  <!-- Scripts -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="../src/js/app.js"></script>
  <script type="module" src="../src/js/firebase.js"></script>
  <script type="module" src="../src/js/navbar-auth.js"></script>
  <script type="module" src="../src/js/logout.js"></script>
  <script type="module" src="../src/js/editar-reporte.js"></script>
</body>
</html>