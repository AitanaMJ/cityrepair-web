<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CityRepair – Inicio</title>
  <link rel="stylesheet" href="src/css/styles.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>

<script type="module">
  import { hasRole } from '/src/js/auth.js';

  function gate(selector, loginMap) {
    document.querySelectorAll(selector).forEach(a => {
      const need = a.dataset.auth; // "citizen" | "worker" | "admin"
      if (!need) return;

      a.addEventListener('click', (e) => {
        if (!hasRole(need)) {
          e.preventDefault();
          const next = a.getAttribute('href') || '/';
          const login = loginMap[need] || '/pages/login.html';
          window.location.href = `${login}?next=${encodeURIComponent(next)}`;
        }
      });
    });
  }

  // Protege navbar y drawer
  const loginMap = {
    citizen: '/pages/login.html',
    worker:  '/pages/edet-login.html',
    admin:   '/pages/edet-login.html',
  };
  gate('.nav-right a[data-auth]', loginMap);
  gate('.drawer-nav a[data-auth]',  loginMap);
</script>


<body>
 <!-- ===== NAVBAR (mismo que index) ===== -->
<header class="navbar">
  <div class="container">
    <div class="brand-left">
      
      <div class="avatar-sm">E</div>
      
      <div class="brand-txt">
        <span class="brand-title">CityRepair</span>
        <span class="brand-sub">Sistema de Reportes EDET</span>
      </div>
    </div>

   <nav class="nav-right">
      <a class="nav-item active" href="../index.html">
        <span class="icon"><i class="bi bi-house"></i></span> Inicio
      </a>
        <!-- Requieren login de usuario -->
  <a class="nav-item" href="/pages/reportar.html" data-auth="citizen">
    <span class="icon"><i class="bi bi-flag"></i></span> Reportar
  </a>
  <a class="nav-item" href="/pages/mis-reportes.html" data-auth="citizen">
    <span class="icon"><i class="bi bi-clipboard2-check"></i></span> Mis Reportes
  </a>

  <a class="nav-item" href="/pages/contacto.html">
    <span class="icon"><i class="bi bi-telephone"></i></span> Contacto
  </a>

  <a class="nav-item" href="/pages/login.html">
    <span class="icon"><i class="bi bi-box-arrow-in-right"></i></span> Acceder
  </a>
</nav>




      

    <button class="hamburger" id="openDrawer" aria-label="Abrir menú">
      <i class="bi bi-list"></i>
    </button>
  </div>
  <div class="navbar-divider"></div>
</header>

<!-- Drawer para móvil (usa las clases que ya estiliza styles.css) -->
<div class="drawer-overlay" id="drawerOverlay"></div>
<aside class="drawer" id="drawer" aria-hidden="true">
  <button class="drawer-close" id="closeDrawer" aria-label="Cerrar">×</button>
  <div class="drawer-header">
    <div class="avatar-sm">E</div>
    <div class="brand-txt">
      <span class="brand-title">CityRepair</span>
      <span class="brand-sub">Sistema de Reportes EDET</span>
    </div>
  </div>
  <nav class="drawer-nav">
  <a class="drawer-link" href="/index.html">Inicio</a>
  <a class="drawer-link" href="/pages/reportar.html" data-auth="citizen">Reportar</a>
  <a class="drawer-link" href="/pages/mis-reportes.html" data-auth="citizen">Mis Reportes</a>
  <a class="drawer-link" href="/pages/contacto.html">Contacto</a>
  <a class="drawer-link" href="/pages/login.html">Acceder</a>
  <a class="drawer-link" href="/pages/edet-login.html">Acceso EDET</a>
</nav>
</aside>

  <!-- ======= HERO ======= -->
  <section class="hero">
    <div class="container hero-inner">
      <div class="avatar-lg">E</div>
      <h1>CityRepair</h1>
      <p class="subtitle">Sistema de Reportes EDET</p>
    </div>
  </section>

  <!-- ======= TARJETAS ======= -->
  <main class="container">
    <section class="cards">
      <!-- Card 1 -->
      <article class="card">
        <div class="card-icon card-icon--green">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
        </div>
        <h3>Reportar Problema</h3>
        <p class="muted">Reporta incidencias eléctricas<br/>en tu zona</p>
        <a id="btnCrearReporte" class="btn btn-green" href="/pages/reportar.html">Crear Reporte</a>

      </article>

      <!-- Card 2 -->
      <article class="card">
        <div class="card-icon card-icon--blue">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm1 7h5l-5-5v5z"/></svg>
        </div>
        <h3>Mis Reportes</h3>
        <p class="muted">Consulta el estado de tus<br/>reportes</p>
        <a class="btn btn-outline" href="pages/mis-reportes.html">Ver Reportes</a>
      </article>

      <!-- Card 3 -->
      <article class="card">
        <div class="card-icon card-icon--blue">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6.6 10.8a16 16 0 0 0 6.6 6.6l2.2-2.2a1.2 1.2 0 0 1 1.2-.3 12 12 0 0 0 3.9.6 1.2 1.2 0 0 1 1.2 1.2V20a1.2 1.2 0 0 1-1.2 1.2A18 18 0 0 1 2.8 6.2 1.2 1.2 0 0 1 4 5h3.3a1.2 1.2 0 0 1 1.2 1.2 12 12 0 0 0 .6 3.9 1.2 1.2 0 0 1-.3 1.2l-2.2 2.5z"/></svg>
        </div>
        <h3>Contacto Rápido</h3>
        <p class="muted">Línea directa para emergencias</p>
        <a class="btn btn-outline" href="pages/contacto.html">Contactar</a>
      </article>
    </section>

   <!-- ====== Acceso EDET (CTA) ====== -->
<section class="container" id="cta-edet">
  <div class="cta-edet">
    <div class="cta-txt">
      <h3>¿Eres empleado de EDET?</h3>
      <p>Accede al panel de gestión para administrar reportes</p>
    </div>

    <a class="btn btn-outline cta-btn" href="pages/edet-login.html">
      <i class="bi bi-briefcase"></i>
      Acceso EDET
    </a>
  </div>
</section>


  <footer class="footer"></footer>

  


  <script src="src/js/app.js"></script>
</body>
</html>
